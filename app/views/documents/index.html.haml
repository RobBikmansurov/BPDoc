-if @directive.blank?
  -title "Каталог Документов"
  -if params[:place].present?
    %h2
      Список Документов, хранящихся в
      [
      = params[:place]
      ]
  -else
    -if params[:dlevel]
      %h2
        Список Документов уровня
        = params[:dlevel]
    -else
      -if params[:part]
        %h2
          Список Документов раздела
          = params[:part]
      -else
        %h1
          Каталог Документов
          -if params[:search].present?
            [ 
            = params[:search]
            ]
-else
  -title "Список внутренних документов банка"
  %h2
    Список Документов, разработанных на основании 
    =link_to @directive.number, directive_path(@directive)

%table
  %tr
    %th
    %th= sortable "name", "Наименование"
    -#%th= sortable "description", "Описание"
    -#    %th Имя файла
    -#%th authority
    %th= sortable "status", "Статус"
    %th= sortable "approved", "От"
    %th Оригинал
    -#%th responsible
    -if can? :destroy, Document
      %th
    
  - @documents.each do |document|
    %tr
      %td= document.part
      %td
        -if can? :view_document, document
          = link_to image_tag('action_go.gif', :alt => 'См.'), document_path(document)+'.pdf'
        = link_to document.name, document_path(document)
      -#      %td= document.filename
      %td= document.status
      %td= document.approved.strftime('%d.%m.%Y') if document.approved
      %td= document.place 
      - if can? :destroy, document
        %td
          = link_to image_tag('action_stop.gif', :alt => 'Удалить'), document, confirm: document.name + "\nДействительно хотите удалить?", :method => 'delete'

.apple_pagination
  = will_paginate @documents 
 
- if can? :create, Document
  .button
    = link_to 'Каталог', documents_path(@document)+'.odt?all=1'
  .button
    = link_to 'ODT', documents_path(@document)+'.odt'
  .button
    = link_to 'Добавить новый документ', new_document_path 
